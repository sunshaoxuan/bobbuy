# PLAN-00: 任务看板总览

**最后更新**: 2026-01-15 13:06  
**状态图例**: ✅ 已完成 | 🔄 进行中 | ⏳ 待开始

---

## 📊 整体进度总览

| 计划 | 状态 | 完成度 | 开始日期 | 截止日期 | 负责人 |
|------|------|--------|----------|----------|--------|
| PLAN-01 | 🔄 部分完成 | 70% | 2026-01-15 | - | 全栈团队 |
| PLAN-02 | ⏳ 待开始 | 0% | 2026-01-16 | 2026-01-23 | 全栈团队 |

---

## 📋 PLAN-01: 下一阶段开发任务规划

### Sprint 1（基础功能完备）- ✅ 已完成

#### 后端开发
- [x] **数据模型增强**
  - [x] 订单生命周期字段与状态更新时间
  - [x] 行程容量与剩余容量计算逻辑
  - [x] 基础费用字段（服务费、预计税费、货币类型）

- [x] **API 设计与实现**
  - [x] 订单状态流转接口（PATCH /api/orders/{id}/status）
  - [x] 行程可用容量校验与锁定接口（POST /api/trips/{id}/reserve）
  - [x] 指标接口补充（按状态统计订单数量）

- [x] **校验与错误码**
  - [x] 统一错误响应结构（ApiResponse + ErrorCode）
  - [x] 参数校验（Java Validation API）

#### 前端开发
- [x] **表单完善**
  - [x] 行程创建表单（日期、容量、状态）
  - [x] 订单创建表单（服务费、币种）

- [x] **状态可视化**
  - [x] 订单状态标签（Ant Design Tag）
  - [x] 行程状态标签

- [x] **数据校验提示**
  - [x] 表单必填与范围校验
  - [x] 关键字段展示说明

---

### Sprint 2（流程闭环与可观测）- 🔄 部分完成

#### 后端开发
- [x] **基础审计日志**
  - [x] 订单状态变化日志（AuditLogService）
  - [x] 行程状态变化日志

- [ ] **可观测性**
  - [x] 健康检查接口（HealthController）
  - [x] 指标接口（MetricsController）
  - [ ] 关键 API 统一日志字段输出（待规范化）

#### 前端开发
- [ ] **流程动作按钮**
  - [ ] 订单状态流转按钮
  - [ ] 行程状态变更入口

- [ ] **日志与提醒**
  - [ ] 订单状态变更记录展示
  - [ ] 异常提醒与空态引导

---

### Sprint 3（质量与验收）- ⏳ 待开始（已转至 PLAN-02）

#### 后端开发
- [x] **测试用例补齐**（部分完成）
  - [x] 后端单元测试占位（2个测试）
  - [ ] 完整单元测试覆盖（目标 ≥50%）
  - [ ] 接口集成测试

- [ ] **性能与异常场景**
  - [ ] 高频下单模拟测试
  - [ ] 并发更新处理测试

#### 前端开发
- [ ] **端到端验收列表**
  - [ ] MVP 核心链路操作清单
  
- [ ] **视觉一致性检查**
  - [ ] 统一间距、字体与色彩基线

---

## 📋 PLAN-02: 测试覆盖率提升计划

### Phase 1: 测试基础设施建设 - ⏳ 待开始
**截止日期**: 2026-01-16

- [ ] **后端测试配置**
  - [ ] 配置 JaCoCo 插件（pom.xml）
  - [ ] 验证覆盖率报告生成

- [ ] **前端测试配置**
  - [ ] 安装测试依赖（Vitest + Testing Library）
  - [ ] 创建 vitest.config.ts
  - [ ] 创建测试工具文件（setup.ts）

---

### Phase 2: 后端单元测试补充 - ⏳ 待开始
**截止日期**: 2026-01-19

- [ ] **BobbuyStore 完整测试**
  - [ ] 订单 CRUD 测试（6个用例）
  - [ ] 订单状态流转测试（3个用例）
  - [ ] 行程容量测试（3个用例）
  - **目标**: 方法覆盖率 ≥80%

- [ ] **AuditLogService 测试**
  - [ ] 日志记录测试（3个用例）
  - **目标**: 方法覆盖率 ≥90%

---

### Phase 3: 前端组件测试 - ⏳ 待开始
**截止日期**: 2026-01-21

- [ ] **Orders 组件测试**
  - [ ] 表单渲染测试
  - [ ] 表单提交测试
  - [ ] 成功/失败消息测试
  - **目标**: 组件覆盖率 ≥70%

- [ ] **Trips 组件测试**
  - [ ] 表单渲染测试
  - [ ] 容量计算测试
  - **目标**: 组件覆盖率 ≥70%

- [ ] **i18n 功能测试**
  - [ ] 默认语言测试
  - [ ] 语言切换测试
  - [ ] 翻译正确性测试

---

### Phase 4: 集成测试与技术债务清偿 - ⏳ 待开始
**截止日期**: 2026-01-23

- [ ] **Controller 集成测试**（可选）
  - [ ] OrderController 测试（7个用例）
  - [ ] TripController 测试（4个用例）

- [ ] **并发控制修复**
  - [ ] 添加 synchronized 或锁机制
  - [ ] 补充并发测试用例

---

## 🎯 里程碑与验收标准

### 里程碑 1: Sprint 1 完成 ✅
**日期**: 2026-01-15  
**成果**: 
- 数据模型完整
- API 接口实现
- 前端表单可用
- I18n 支持完整

### 里程碑 2: 测试基础设施就绪 ⏳
**日期**: 2026-01-16  
**验收标准**:
- [x] JaCoCo 报告可生成
- [x] Vitest 可运行测试
- [x] 覆盖率工具配置完成

### 里程碑 3: 测试覆盖率达标 ⏳
**日期**: 2026-01-23  
**验收标准**:
- [x] 后端覆盖率 ≥50%
- [x] 前端覆盖率 ≥60%
- [x] 所有测试通过

---

## 🔴 阻塞问题与技术债务

### 高优先级（P0）
1. ❌ **测试覆盖率不足** - 来源: AUDIT-04
   - 现状: 后端 ~15%, 前端 0%
   - 目标: 后端 ≥50%, 前端 ≥60%
   - 截止: 2026-01-23
   - 状态: ⏳ 待 PLAN-02 执行

2. ❌ **未配置覆盖率工具** - 来源: AUDIT-04
   - 影响: 无法量化代码质量
   - 截止: 2026-01-16
   - 状态: ⏳ 待执行

### 中优先级（P1）
3. ❌ **并发控制缺失** - 来源: AUDIT-01
   - 位置: `reserveTripCapacity` 方法
   - 风险: 高并发下容量超卖
   - 截止: 2026-01-22
   - 状态: ⏳ 待执行

4. ❌ **Controller 层无测试** - 来源: AUDIT-04
   - 影响: API 回归风险高
   - 截止: 2026-01-23
   - 状态: ⏳ 可选

### 低优先级（P2）
5. ⏳ **E2E 测试缺失** - 来源: AUDIT-01
   - 工具: Playwright
   - 状态: 计划中（PLAN-03）

---

## 📈 进度统计

### 总体完成度
- **PLAN-01 Sprint 1**: 100% ✅
- **PLAN-01 Sprint 2**: 40% 🔄
- **PLAN-01 Sprint 3**: 0% ⏳ → PLAN-02
- **PLAN-02 Phase 1-4**: 0% ⏳

### 测试覆盖率进度
| 模块 | 当前 | Phase 2 目标 | 长期目标 |
|------|------|-------------|----------|
| 后端 - Line | 15% | 50% | 70% |
| 前端 - Line | 0% | 60% | 75% |

### 技术债务清偿进度
- **已解决**: 4/8（50%）
  - ✅ 前端提交逻辑
  - ✅ I18n 支持
  - ✅ 审计日志
  - ✅ API 文档

- **未解决**: 4/8（50%）
  - ❌ 测试覆盖率
  - ❌ 并发控制
  - ❌ Controller 测试
  - ❌ E2E 测试

---

## 🚀 下一步行动

### 本周（2026-01-16 ~ 2026-01-19）
1. **立即执行**: PLAN-02 Phase 1（测试基础设施）
2. **次要优先**: PLAN-02 Phase 2（后端单元测试）
3. **并行推进**: PLAN-01 Sprint 2 剩余任务（前端流程按钮）

### 下周（2026-01-20 ~ 2026-01-23）
1. **主要任务**: PLAN-02 Phase 3（前端组件测试）
2. **次要任务**: PLAN-02 Phase 4（并发控制修复）
3. **验收准备**: 覆盖率报告生成与验证

---

**备注**: 
- 本看板每日更新一次
- 如有任务状态变更，请立即更新此文档并推送到 Git
- 阻塞问题优先级如有变化，需同步修改
